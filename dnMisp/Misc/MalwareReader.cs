using System.Collections.Generic;
using System.IO;

namespace dnMisp.Misc
{
    public class MalwareReader
    {
        public string FullName { get; internal set; }
        public byte[] Content { get; internal set; }

        public Dictionary<string, Stream> Entries { get; set; }

        public MalwareReader(Dictionary<string, Stream> entries)
        {
            Entries = entries;

            foreach(var v in Entries)
            {
                v.Value.Seek(0, SeekOrigin.Begin);

                if (v.Key.Contains(".filename."))
                {
                    StreamReader reader = new StreamReader(v.Value);
                    FullName = reader.ReadToEnd();
                } 
                else
                {
                    BinaryReader reader = new BinaryReader(v.Value);
                    Content = reader.ReadBytes((int)v.Value.Length);
                }
            }
        }
    }
}