using dnMisp.Enums;
using dnMisp.Misc;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Text;

namespace dnMisp.Objects
{
    public class MalwareConfig 
        : MispObject
    {
        public MalwareConfig(
            string config, 
            string format = "other", 
            string encrypted = null, 
            string password = null)
        {
            Name = "malware-config";
            MetaCategory = "file";

            Attributes.Add(new Attribute("attachment", "Artifacts dropped", "Full Configuration File") { ObjectRelation = "config", Data = Helper.ConvertToBase64( config) });
            Attributes.Add(new Attribute("text", "Other", format) { ObjectRelation = "format" });

            if (!string.IsNullOrEmpty(encrypted))
                Attributes.Add(new Attribute("text", "Other", format) { ObjectRelation = "encrypted" });

            if (!string.IsNullOrEmpty(password))
                Attributes.Add(new Attribute("text", "Other", format) { ObjectRelation = "password" });

        }
    }
}
